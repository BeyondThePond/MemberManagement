language: python
os: linux

jobs:
  include:
    # chrome
    - env:
      - SELENIUM_WEBDRIVER=default
      - ENABLE_GEOCACHE_TEST=1
      addons:
        chrome: stable
      before_install:
        - export CHROMEDRIVER_VERSION=79.0.3945.36
        - wget -N http://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip
        - mkdir chromedriver
        - unzip chromedriver_linux64.zip -d chromedriver
        - chmod +x chromedriver/chromedriver
        - export PATH=$PATH:$PWD/chromedriver

    # firefox
    - env:
        - SELENIUM_WEBDRIVER=firefox
        - ENABLE_GEOCACHE_TEST=1
      addons:
        firefox: latest
      before_install:
        - export GECKODRIVER_VERSION=v0.26.0
        - wget https://github.com/mozilla/geckodriver/releases/download/$GECKODRIVER_VERSION/geckodriver-$GECKODRIVER_VERSION-linux64.tar.gz
        - mkdir geckodriver
        - tar -xzf geckodriver-$GECKODRIVER_VERSION-linux64.tar.gz -C geckodriver
        - export PATH=$PATH:$PWD/geckodriver

python:
  - "3.8"

install:
  - pip install -r requirements.txt
  - pip install -r requirements-dev.txt

script:
  - pytest
